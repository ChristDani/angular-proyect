<h4 mat-dialog-title class="text-center mt-4">Simulador</h4>

<mat-dialog-content class="dialog-content">
  <form [formGroup]="form" class="form">
    <mat-form-field appearance="outline">
      <mat-label>Monto</mat-label>
      <input
        matInput
        type="number"
        inputmode="decimal"
        formControlName="amount"
        min="100"
        step="100"
        placeholder="Ej. 10000"
      />
      <mat-error *ngIf="form.controls.amount.hasError('required')">Requerido</mat-error>
      <mat-error *ngIf="form.controls.amount.hasError('min')">Mínimo 100</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Tasa anual (%)</mat-label>
      <input
        matInput
        type="number"
        inputmode="decimal"
        formControlName="rate"
        min="0"
        step="0.1"
        placeholder="Ej. 20"
      />
      <mat-error *ngIf="form.controls.rate.hasError('required')">Requerido</mat-error>
      <mat-error *ngIf="form.controls.rate.hasError('min')">No puede ser negativa</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Cuotas (meses)</mat-label>
      <input
        matInput
        type="number"
        inputmode="numeric"
        formControlName="n"
        min="1"
        max="360"
        step="1"
        placeholder="Ej. 12"
      />
      <mat-error *ngIf="form.controls.n.hasError('required')">Requerido</mat-error>
      <mat-error *ngIf="form.controls.n.hasError('min')">Mínimo 1</mat-error>
      <mat-error *ngIf="form.controls.n.hasError('max')">Máximo 360</mat-error>
    </mat-form-field>
  </form>

  <!-- Mostramos resultados cuando el form es válido -->
  @if (form.valid) {
    <div class="result">
      <div>
        Cuota estimada:
        <strong>{{ cuota() | currency:'PEN':'symbol-narrow':'1.2-2' }}</strong>
      </div>
      <div class="sub">
        Total pagado:
        <span>{{ totalPagado() | currency:'PEN':'symbol-narrow':'1.2-2' }}</span>
        • Costo financiamiento:
        <span>{{ costoFinanciamiento() | currency:'PEN':'symbol-narrow':'1.2-2' }}</span>
      </div>
    </div>
  }
</mat-dialog-content>

<mat-dialog-actions align="end">
  <div class="actions">
    <button mat-button mat-dialog-close>Cerrar</button>
  </div>
</mat-dialog-actions>
